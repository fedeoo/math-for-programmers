# 斐波那契数列

大家对这个数列再熟悉不过了，学习递归的时候经常会拿来练习，当然递归解法并不太好，因为存在很多的重叠子问题。不过这个数列本身就很有意思，这篇文章就是介绍一下这个数列有意思的性质，顺便回忆一下高中数学知识。

## 定义
斐波那契数又叫兔数，斐波那契最先研究这个数列的时候就是以兔子的繁殖为例描述的。最开始只有一对小兔子，一个月之后小兔子长大了变成大兔子，大兔子每个月都会生下小兔子，假设兔子不会死，第 n 个月的兔子数就是斐波那契数。我们用递归式来定义**斐波那契数**：

$$\begin{aligned}
F_0 &= 0 \\\\
F_1 &= 1 \\\\
F_n &= F_{n - 1} + F_{n - 2}    n > 2 \\\\
\end{aligned}$$
产生的序列为

$$0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144, ...$$


## 黄金分割
开普勒发现斐波那契数前后两项之比趋近于黄金分割数。也就是说：

$$\lim_{n \to \infty}\frac{F_n}{F_{n-1}} \approx a = 1/2 (1 + \sqrt{5})$$

我们先来算一下，假定这个极限存在：

$$\lim_{n \to \infty}\frac{F_n}{F_{n-1}} = \lim_{n \to \infty}\frac{F_{n - 1} + F_{n - 2}}{F_{n-1}} = \lim_{n \to \infty}\frac{F_{n-1}}{F_{n-2}}$$

然后我们发现求解这个极限就相当于解方程

$$x^2 = x + 1$$

由求根公式，可以得到两个解：

$$\begin{aligned}
\phi = \frac{1 + \sqrt{5}}{2} = 1.61803 \\\\
\hat{\phi} = \frac{1 - \sqrt{5}}{2} = -0.61803
\end{aligned}$$

其中 $\phi$ 是黄金分割数，$\hat{\phi}$ 是其共轭数。

## 通项公式
当我们需要求第 n 个斐波那契数时，除了递归或循环以为，我们可能会想到，是否有一个通项公式，直接计算出这个值。我们再看一下它的递推公式 $F_n = F_{n - 1} + F_{n - 2}$ 感觉一脸懵逼，无从下手。
没关系，我们先来回忆下等比数列    
递推公式为 $a_{n + 1} = a_{n} * q$  我们也很容易得到通项公式 $a_{n + 1} = a_1 * q^n$
对于不是很规整的递推公式 $a_{n + 1} = a_{n} * q + b$ 我们也可以用换元法解决。

下面进入正题，$a_n = a_{n - 1} + a_{n - 2}$ 我们可以转换成这样的等比数列
$a_n + \alpha a_{n - 1} = \beta(a_{n - 1} + \alpha a_{n - 2})$

最后我们解得： $\alpha = \frac{\sqrt{5} - 1}{2}$ $\beta = \frac{\sqrt{5} + 1}{2}$

$a_n + \alpha a_{n - 1} = \beta^{n - 1}$

现在只有两项了，我们就可以再次换元得到新的等比数列，注意右边数字并非常量而是与 n 有关，我们不能直接移项。令 $b_n = \frac{a_n}{\beta^n}$ 我们得到新的递推式 $b_{n + 1} + \frac{\alpha}{\beta} b_{n} = \frac{1}{\beta}$ 以及新的等比数列

$b_{n+1} - \frac{1}{\alpha + \beta} = -\frac{\alpha}{\beta}(b_n - \frac{1}{\alpha + \beta})$

$b_n - \frac{1}{\alpha + \beta} = {(-\frac{\alpha}{\beta})}^{n - 1}(b_1  - \frac{1}{\alpha + \beta)}$

由于 $b_n = \frac{a_n}{\beta^n}$ 以及 a_1 = 1 得到 $b_1 = \frac{1}{\beta}$

最后，终于求出 $a_n$ 的通项公式

$$\begin{aligned}
a_n &= b_n \beta^n \\\\
    &= \frac{1}{\alpha + \beta} \beta^n + {(-\alpha)}^{n - 1}(1 - \frac{\beta}{\alpha + \beta}) \\\\
    &= \frac{1}{\alpha + \beta} \beta^n + {(-\alpha)}^{n - 1}(\frac{\alpha}{\alpha + \beta}) \\\\
    &= \frac{1}{\alpha + \beta} \beta^n - {(-\alpha)}^{n}(\frac{1}{\alpha + \beta}) \\\\
    &= \frac{1}{\alpha + \beta}(\beta^n - {(-\alpha)}^{n}) \\\\
    &=  \frac{1}{\sqrt{5}}\left [ (\frac{1+\sqrt{5}}{2})^{n} - (\frac{1-\sqrt{5}}{2})^n  \right ]
\end{aligned}$$

当 n 比较大的时候，由于 $\frac{1-\sqrt{5}}{2} < 1$ 我们可以直接忽略这一项，其值为 $\frac{1}{\sqrt{5}}(\frac{1+\sqrt{5}}{2})^{n}$ 舍入最近的整数。

## 总结

借斐波那契数我们温习了一下极限以及通项公式。斐波那契数列的通项公式的求法有很多种，上面这种方法不需要任何数学基础就可以推导。个人觉得借助生成函数进行推导更为简单，见算法导论习题 4.4。斐波那契数在自然界中很常见，一个谣言是花瓣数都是斐波那契数，虽说是谣言，也确实可见斐波那契数在自然界中相对常见。
> 不过并非所有植物的叶片和花瓣数都是斐波那契数，见果壳辟谣 https://www.guokr.com/article/69761/

